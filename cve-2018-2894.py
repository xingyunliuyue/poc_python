# coding:utf-8
import requests
import argparse

def argument():
    parser = argparse.ArgumentParser(description='useage:python3 demo2.py -u [url]')
    parser.add_argument('-u','--url',type=str,metavar='',required=True,help="Please input the vulnerable url'")
    args = parser.parse_args()
    return args

def banner():
    print("""
  _______      ________    ___   ___  __  ___      ___   ___   ___  _  _   
 / ____\ \    / /  ____|  |__ \ / _ \/_ |/ _ \    |__ \ / _ \ / _ \| || |  
| |     \ \  / /| |__ ______ ) | | | || | (_) |_____ ) | (_) | (_) | || |_ 
| |      \ \/ / |  __|______/ /| | | || |> _ <______/ / > _ < \__, |__   _|
| |____   \  /  | |____    / /_| |_| || | (_) |    / /_| (_) |  / /   | |  
 \_____|   \/   |______|  |____|\___/ |_|\___/    |____|\___/  /_/    |_|                                                                      
 """)
def Poc():
    args=argument()
    url=args.url
    headers={'User-Agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/112.0.0.0 Safari/537.36'}
    try:
        res=requests.get(url=url,headers=headers,timeout=10,verify=False,allow_redirects=False)
        if '<name>BasicConfigOptions.workDir</name>' in res.text:
            print('存在漏洞')
        else:
            print('不存在漏洞')
    except Exception as e:
        print('请检查是否输入正确')

if __name__ == '__main__':
    banner()
    Poc()
